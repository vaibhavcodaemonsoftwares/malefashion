!function(i,n){var t;i(document.body).is(".single-product")&&((t=function(){n.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this)),this.old_qty=this.get_quantity()}).prototype=i.extend({},n.BaseGateway.prototype,n.ProductGateway.prototype,n.PaymentRequest.prototype),t.prototype.initialize=function(){if(!i(this.container).length)return setTimeout(this.initialize.bind(this),1e3);n.ProductGateway.call(this),n.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){n.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){i(document.body).on("change",'[name="quantity"]',this.add_to_cart.bind(this)),i(this.container).parent().parent().addClass("active"),this.is_variable_product()?this.variable_product_selected()?(this.cart_calculation(this.get_product_data().variation.variation_id),i(this.container).removeClass("processingFoundVariation")):this.disable_payment_button():this.cart_calculation()}.bind(this))},t.prototype.add_to_cart=function(t){this.disable_payment_button(),this.old_qty=this.get_quantity();var e=this.get_product_data().variation;this.is_variable_product()&&!this.variable_product_selected()||this.cart_calculation(e.variation_id).then(function(){this.is_variable_product()&&i(this.container).is(".processingFoundVariation")?(this.createPaymentRequest(),this.createPaymentRequestButton(),n.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){this.enable_payment_button(),i(this.container).removeClass("processingFoundVariation")}.bind(this))):this.enable_payment_button()}.bind(this))},t.prototype.cart_calculation=function(){return n.ProductGateway.prototype.cart_calculation.apply(this,arguments).then(function(){this.paymentRequest.update(this.get_payment_request_update({total:{pending:!1}}))}.bind(this))["catch"](function(){}.bind(this))},t.prototype.create_button=function(){i("#wc-stripe-payment-request-container").empty(),n.PaymentRequest.prototype.create_button.apply(this,arguments),this.$button=i("#wc-stripe-payment-request-container")},t.prototype.button_click=function(t){this.$button.is(".disabled")?t.preventDefault():0==this.get_quantity()&&(t.preventDefault(),this.submit_error(this.params.messages.invalid_amount))},t.prototype.found_variation=function(){i(this.container).addClass("processingFoundVariation"),n.ProductGateway.prototype.found_variation.apply(this,arguments)},t.prototype.block=function(){i.blockUI({message:this.adding_to_cart?this.params.messages.add_to_cart:null,overlayCSS:{background:"#fff",opacity:.6}})}),i(document.body).is(".woocommerce-cart")&&((t=function(){n.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this))}).prototype=i.extend({},n.BaseGateway.prototype,n.CartGateway.prototype,n.PaymentRequest.prototype),t.prototype.initialize=function(){n.CartGateway.call(this),n.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){n.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){i(this.container).addClass("active").parent().addClass("active")}.bind(this))},t.prototype.updated_html=function(){i(this.container).length||(this.can_pay=!1),this.can_pay&&this.initialize()},t.prototype.button_click=function(t){this.paymentRequest.update(this.get_payment_request_update({total:{pending:!1}}))},t.prototype.cart_emptied=function(t){this.can_pay=!1}),i(document.body).is(".woocommerce-checkout")&&((t=function(){n.BaseGateway.call(this,wc_stripe_payment_request_params),window.addEventListener("hashchange",this.hashchange.bind(this))}).prototype=i.extend({},n.BaseGateway.prototype,n.CheckoutGateway.prototype,n.PaymentRequest.prototype),t.prototype.initialize=function(){n.CheckoutGateway.call(this),i("form.checkout").on("change",".form-row:not(.address-field) .input-text",this.update_payment_request.bind(this)),i(this.container).length&&n.PaymentRequest.prototype.initialize.call(this)},t.prototype.canMakePayment=function(){n.PaymentRequest.prototype.canMakePayment.apply(this,arguments).then(function(){var t;this.show_icons(),this.banner_enabled()&&(i(this.banner_container).empty().show().append('<div id="wc-stripe-payment-request-banner"></div>'),i(this.banner_container).show().parent().parent().addClass("active"),(t=this.stripe.elements().create("paymentRequestButton",{paymentRequest:this.paymentRequest,style:{paymentRequestButton:{type:this.params.button.type,theme:this.params.button.theme,height:this.params.button.height}}})).on("click",this.banner_checkout.bind(this)),t.mount("#wc-stripe-payment-request-banner"))}.bind(this))},t.prototype.create_button=function(){this.$button&&this.$button.remove(),this.$button=i('<div id="wc-stripe-payment-request-container"></div>'),i("#place_order").after(this.$button),n.PaymentRequest.prototype.create_button.call(this),this.trigger_payment_method_selected()},t.prototype.updated_checkout=function(){i(this.container).length&&n.PaymentRequest.prototype.initialize.call(this)},t.prototype.banner_checkout=function(t){this.set_payment_method(this.gateway_id),this.set_use_new_option(!0),i('[name="terms"]').prop("checked",!0)},t.prototype.on_token_received=function(){n.CheckoutGateway.prototype.on_token_received.apply(this,arguments),this.fields.toFormFields(),this.payment_request_options.requestShipping&&this.maybe_set_ship_to_different(),this.checkout_fields_valid()&&this.get_form().submit()},t.prototype.update_payment_request=function(){i(this.container).length&&n.PaymentRequest.prototype.initialize.call(this)},t.prototype.show_icons=function(){i(this.container).length&&i(this.container).find(".wc-stripe-paymentRequest-icon.gpay").show()}),new t}(jQuery,window.wc_stripe);